@using MrCMS.ACL
@using MrCMS.ACL.Rules
@using MrCMS.Settings
@model MrCMS.Entities.Documents.Web.Webpage
@inject SiteSettings SiteSettings
<link href="@Url.Content("~/Areas/Admin/Content/Styles/mrcms-frontendediting.css")" rel="stylesheet" type="text/css"/>
<link href="@Url.Content("~/Areas/Admin/Content/Styles/featherlight.css")" rel="stylesheet" type="text/css"/>
<link href="@Url.Content("~/Areas/Admin/Content/Styles/jquery.mrcms-mediaselector.css")" rel="stylesheet" type="text/css"/>
@{
    var canEditPage = Html.CanAccess<TypeACLRule>(TypeACLRule.Edit, Model.GetType().FullName);
}
<div class="mrcms-admin-nav-bar">
    <a href="@Url.Action("Index", "Home", new {area = "Admin"})" target="_parent" class="mrcms-btn mrcms-btn-default mrcms-btn-xs">Admin</a>
    @if (canEditPage)
    {
        <a href="@Url.Action("Edit", "Webpage", new {Model.Id, area = "Admin"})" target="_parent" class="mrcms-btn mrcms-btn-xs mrcms-btn-primary">Edit</a>
        if (Model.Published)
        {
            <a id="unpublish-now" class="mrcms-btn mrcms-btn-xs mrcms-btn-success">Unpublish</a>
        }
        else
        {
            <a id="publish-now" class="mrcms-btn mrcms-btn-xs mrcms-btn-warning">Publish</a>
        }
    }
    @if (Model.CanAddChildren())
    {
        @Html.ActionLink("Add a child page", "Add", "Webpage", new {id = Model.Id, area = "Admin"}, new {@class = "mrcms-btn mrcms-btn-xs mrcms-btn-default"})
    }

    @Html.ActionLink("Add page", "Add", "Webpage", new {id = Model.Parent?.Id, area = "Admin"}, new {@class = "mrcms-btn mrcms-btn-xs mrcms-btn-default"})

    @if (Html.CanAccess<InlineEditingACL>("Allowed"))
    {
        <a id="enable-editing" class="mrcms-btn mrcms-btn-xs mrcms-btn-default">Inline Editing: On</a>
    }
    <a href="/logout" class="mrcms-btn mrcms-btn-xs mrcms-btn-default" style="float: right;">Logout</a>
    @if (SiteSettings.SiteIsLive)
    {
        <a href="/Admin/Settings#site-settings" class="mrcms-btn mrcms-btn-xs mrcms-btn-success" style="float: right;">Site is set live</a>
    }
    else
    {
        <a href="/Admin/Settings#site-settings" class="mrcms-btn mrcms-btn-xs mrcms-btn-warning" style="float: right;">Site is not set live</a>
    }
</div>

@Html.HiddenFor(webpage => webpage.Id)
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
@{
    Html.IncludeScript("~/Areas/Admin/Content/Editors/ckeditor/ckeditor.js");
    Html.IncludeScript("~/Areas/Admin/Content/Scripts/lib/store.js");
    Html.IncludeScript("~/Areas/Admin/Content/Scripts/lib/dropzone.js");
    Html.IncludeScript("~/Areas/Admin/Content/Scripts/lib/featherlight.js");

    Html.IncludeScript("~/Areas/Admin/Content/Scripts/mrcms/front-end-editing.js");
    Html.IncludeScript("~/Areas/Admin/Content/Scripts/mrcms/mrcms-media-selector.js");
    Html.IncludeScript("~/Areas/Admin/Content/Scripts/mrcms/media-uploader.js");
}